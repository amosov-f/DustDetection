\documentclass[14pt]{article}
\usepackage[cp1251]{inputenc}
\usepackage[english,russian]{babel}
\inputencoding{cp1251}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{indentfirst}
\usepackage{epsfig}
\usepackage{ccaption}
\usepackage{amsmath}
\DeclareMathOperator{\sign}{sign}

\textwidth 16.5cm
\textheight 22cm
\voffset=-1.4cm
\hoffset=-2.3cm

\author{Ф.Амосов}
\title{\bf Определение параметров межзвездного поглощения света по данным каталога Hipparcos}

\begin{document}
    \maketitle

    \begin{abstract}
        Основная задача исследования –- построение метода автоматического поиска пылевых облаков в окрестности Солнца на основе массовых каталогов звезд. На первом этапе метод был применен к данным каталога Hipparcos, а именно
        для построения двумерной панорамы распределения пылевых облаков на небесной сфере.
        Метод исследования основан на сравнении эталонного показателя цвета звезды данного спектрального класса с наблюдаемым показателем цвета.
        Так как полная двумерная спектральная классификация известна не для всех звезд каталога Hipparcos,
        была решена вспомогательная задача: используя параллаксы звезд каталога Hipparcos дополнить информацию о
        звездах классом светимости на основе данных о видимой звездной величине и параллаксе звезды.
        В результате работы была построена карта распределения пылевой материи, вызывающей покраснения света звезд, на небесной сфере.
        Недостаточная плотность звезд и низкие относительные точности параллаксов для далеких звезд не позволяют полностью использовать возможности метода,
        которые будут полностью раскрыты по завершении миссии GAIA
   \end{abstract}

    \section{Введение}
        %Постановка задачи. Общая задача – 3D, будет возможна после GAIA. Частная задача. Полстраницы

        Общая задача поиска облаков межзвездной пыли, ответственной за поглощение света звезд, является трехмерной.
        Для ее надежного выполнения необходим массовый каталог параллаксов звезд. На сегодняшний день таким каталогом является Hipparcos,
        но, как мы увидим, его точности недостаточно для решения этой задачи. Видимо её полное решение будет возможно только
        после получения результатов миссии GAIA, чьей основной задачей является определение структуры Млечного Пути в окрестности Солнца.
        Поэтому мы представим решение частной задачи -- задачи построения двумерного распределения пыли по небесной сфере.
        Ее решение позволит по крайней мере определить направления наибольшего поглощения и изменения таких характеристик звезд как звездная величина и
        показатель цвета
        Это позволит в будущем учитывать межзвездное поглощение при определении характеристик звезды таких как, к примеру, показатель цвета.

    \section{Исходные данные}
        %Каталог Hipparcos – приводите сведения о точности параллаксов, особенно об относительной точности расстояний. Диаграмма «относительная точность от расстояния». Фотометрия. Bt Vt и связь ее с B-V классической. В каталоге Hip 2007 приведены данные B-V. Спектральная классификация. Наличие двумерной спектральной классификации. Картинка о наличии классов светимости.

        Для определения параметров межзвездного поглощения, нам потребуется иметь следующие данные о звездах,
        \begin{itemize}
            \item положение
            \item параллакс
            \item фотометрия
            \item спектральный класс и класс светимости
        \end{itemize}
        Мы будем использовать модифицированный каталог Hipparcos \cite{hipparcos}, ввиду того, что у подавляющего большинства звезд присутствуют все необходимые данные.

        \subsection{Сведения о каталоге}
            Каталог Hipparcos содержит данные о 117955 звездах. У некоторых звезд отсутствуют необходимые нам данные, поэтому в данной статье мы будем работать с меньшим числом звезд.
            \subsubsection{Параллакс}
                Звезды в каталоге Hipparcos имеют низкую точность параллакса. Это можно видеть из следующей гистограммы. На ней отложены средние значения относительной ошибки в расстоянии для звезд на  разных расстояниях.
                \begin{figure}[h]
                    \begin{center}
                        \includegraphics[width=10cm]{r-r_rel.eps}
                        \caption{\rm Относительная ошибка в расстоянии от расстояния}
                        \label{pi_accuracy}
                    \end{center}
                \end{figure}                
                Мы видим что, например, на расстоянии в 500 пк ошибка в параллаксе достигает 50\%.
            \subsubsection{Положение}
                Ошибки в положении звезд на небе на порядок меньше ошибок в параллаксе, поэтому их можно не учитывать, если нас интересует пространственное распределение звезд.
            \subsubsection{Фотометрия}
                В каталоге Hipparcos 2007 \cite{hipparcos} приведены данные фотометрии звезд. Показатель цвета $B-V$ присутствует у всех звезд. %надо дописать
            \subsection{Спектральная классификация}
                В каталоге Hipparcos имеются данные о спектрах и спектральных данных для 110707 звезды. Эти данные заимствованы из наземных наблюдений. Дополнительная информация о спектральных классах содержится в каталоге Tycho 2 Spectral Type. К сожалению, в этом каталоге  информация о спектральных данных звезд приведена только для звезд южного экваториального полушария,
                \begin{figure}[h]
                    \begin{center}
                        \includegraphics[width=10cm]{has-lumin.eps}
                        \caption{\rm Распределение наличия классов светимости}
                        \label{pi_accuracy}
                    \end{center}
                \end{figure}                 
                На этом рисунке изображена небесная сфера в галактической системе координат (в центре центр галактики), разбитая на <<пиксели>> алгоритмом HEALPix \cite{healpix}. Далее мы подробнее его разберем. Чем больше в пикселе доля звезд, имеющих класс светимости в каталоге Tycho 2 Spectral Type, тем он краснее. Видим отсутствие класса светимости практически у всех звезд северного экваториального полушария и присутствие у южного.


    \section{Покраснение}
        %Основное уравнение Obs – Int. Обсуждение уравнения: примеры за и против.  Необходимые данные для получения табличных значений показателя цвета звезды: Sp и класс светимости. «Отрицательное покраснение»: где и когда встречаются. Ссылки на уже обнаруженные несоответствия. Влияние пылевой материи на покраснение и ослабление блеска звезд. Теоретическая кривая покраснения в некотором направлении. Интерпретация кривой. Этот раздел должен быть не слишком мал.


        \subsection{Определение}
            Межзвездное поглощение может быть описано избытком цвета. Избыток цвета мы будем называть <<покраснением>>. {\it Покраснение} звезды есть
                $$
                    E = E_{B - V} = (B - V)_{obs} - (B - V)_{int}
                $$
            Где $(B - V)_{obs}$ --- ее видимый нами показатель цвета, а $(B - V)_{int}$ --- реальный показатель цвета звезды. $(B - V)_{obs}$ мы можем получить на основе данных фотометрии звезды. Их мы получим из каталога. $(B - V)_{int}$ можно оценить статистически. Это проделано во многих работах, к примеру, в [4]. В результате, мы воспользуемся полученной в [4] двумерной таблицей <<спектральный класс, класс светимости --- показатель цвета>>. То есть для получения $(B - V)_{int}$ звезды нам потребуются ее спектральный класс и класс светимости. Их мы можем получить из данных каталога. Приведем пример расчета покраснения на звезде HIP 44800,
                \begin{itemize}
                    \item У нее в каталоге $(B - V)_{obs} = 0.535^m$
                    \item Класс F7V, поэтому (по [4]) $(B - V)_{int} = 0.493^m$
                    \item Покраснение $0.535^m - 0.493^m = 0.042^m$
                \end{itemize}
                Покраснение --- это количественное измерение межзвездного поглощения, поэтому мы можем сказать, что <<между нами и звездой HIP 44800 пыли на $0.042$ зв. вел>>.

        \subsection{Идеальная кривая покраснения}
            Предположим, что на некотором луче зрения бесконечно много звезд и они расположены на нем всюду плотно. Пусть для каждой звезды мы можем идеально измерить ее покраснение. Тогда, ход покраснения на этом луче зрения должен иметь следующий вид,
            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{ideal-1-no-tick.eps}
                    \caption{\rm Идеальный ход покраснения на луче зрения}
                    \label{pi_accuracy}
                \end{center}
            \end{figure} 
            

            Где по оси $x$ отложено расстояние по лучу зрения, а по $y$ --- покраснение у соответствующих звезд. Покраснение должно всегда монотонно расти, т.к. пыль присутсвует всюду.  Очевидно, что там, где покраснение растет быстрее - пыли больше, там где медленнее - меньше. Поэтому, можно было бы сказать, что облака на этом луче зрения находятся там, где покраснение растет <<очень быстро>> (синие области),

            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{ideal-2-no-tick.eps}
                    \caption{\rm Облака на идеальной кривой покраснения}
                    \label{pi_accuracy}
                \end{center}
            \end{figure} 
            
            Тем самым, построение кривых покраснения в разных направлениях на небе может позволить находить области повышенного мезвездного поглощения, то есть находить пылевые облака.


        %Существуют таблицы <<спектральный класс, класс светимости --- показатель цвета>>, поэтому для каждой звезды из каталога Hipparcos, у которой есть видимый показатель цвета и спектральный класс, можно вычислить покраснение. Если мы для всех таких звезд знаем еще и их пространственные координаты с хорошей точностью, то мы можем говорить о пространственном распределении покраснения. В данной работе мы рассмотрим это распределение с точки зрения трендов покраснения в различных направлениях. Результатом работы будут коэффициенты $a$ и $b$ этих трендов $ar + b$.



    \section{Способ получения классов светимости}
        %Из каталога (Tycho 2 Sp Types в Hipparcos 2007). Здесь можно рассказать о достоинствах метода автоматического обучения. Обучащающее множество. Качество классификации. III и V классы светимости. Картинки. Результаты дополнения каталога классами светимости.

        Как мы увидели в обзоре данных каталога Hipparcos, практически у всех звезд северного экваториального полушария отсутствует класс светимости. Для нас его наличие чрезвычайно важно, ввиду того, что мы на основе класса светимости и спектрального класса рассчитываем истинное значение $B - V$ для звезд ($(B - V)_{int}$). Тем самым, отсутствие класса светимости у половины звезд делает невозможным проведение наших расчетов для всего северного полушария.

        Исправим это. Определим неизвестные классы светимости. Сделаем это с помощью методов машинного обучения. Натренируем классификатор, который будет выдавать класс светимости для звезды по двум факторам - ее показателю цвета и ее абсолютной звездной величине. Этих факторов будет достаточно, т.к. классы светимости теоретически разделимы на диаграмме Гершпрунга-Рассела. 

        Доля звезд, которые относятся ни к III, ни к V классам мала (16,3\%, 8058 из 49285, имеющих класс светимости). Поэтому, мы упростим задачу --- обучим линейный бинарный классификатор, который будет предсказывать III или V класс. Сделаем это с помощью метода опорных векторов \cite{svm} с обычным линейным ядром. 
        
         В качестве обучающего множества возьмем все звезды, у которых присутствует класс светимости в каталоге и он либо III, либо V. Таких звезд $41227$ ($20027$ III класса, $21200$ V класса). Обучим на них классификатор --- получим разделяющую классы прямую (рис. 5).
        \begin{figure}[h]
            \begin{center}
                \includegraphics[width=10cm]{classify.eps}
                \caption{\rm Обучающее множество с полученной разделяющей прямой. Так же, здесь изображены теоретические кривые для классов на основе таблиц \cite{tsvetkov}}
                \label{pi_accuracy}
            \end{center}
        \end{figure}
        
        Уравнение разделяющей прямой, 
        $$-2.9876 \cdot (B - V) + 0.4526 \cdot M + 1.3547 = 0$$
        где $B-V$ -- показатель цвета, $M$ -- абсолютная звездная величина.
        
        Мы видим, что при показателе цвета $B-V \ge 0.6$ классификатор работает практически идеально, но при $B-V < 0.6$ работает не совсем верно --- выдает V класс при большом числе звезд III класса (12,7\%, 2222 из 17499). При $B-V < 0.6$ звезды III и V класса неразделимы, поэтому для этой половины можно принять другое решение --- результат работы классификатора будет взвешенным средним III и V классов, то есть некоторым средним классом, $(B-V)_{int}$ у которого будет равен $w_1 \times (B-V)_{int} (III) + w_2 \times (B-V)_{int} (V), w_1 + w_2 = 1$. Веса $w_1$ и $w_2$ логично взять в соответствии с долей классов в этой области (12.7\%/87.3\%). 
        
        В таблице двумерной спектральной классификации \cite{tsvetkov} у спектрального типа G2 показатель цвета при III классе 0.733, при V --- 0.630. Это максимальная разница между III и V классом в интересующем нас диапазоне. Класс, соответствующий средневзвешенному решению будет иметь показатель цвета $12.7\% \cdot 0.733 + 87.3\% \cdot 0.630 = 0.643$. Отличие от V класса минимальное --- 0.01 зв. вел. --- гораздо ниже уровня каталожных ошибок. Поэтому, решение классификатора в этой области можно считать приемлемым.
       
        Для количественной оценки качества работы классификатора, проведем 10-fold кросс-валидацию. Ниже приведены ее результаты, \\
        \begin{center}
            \begin{tabular} {| c | c | c | c |}
                \hline
                Классифицированы как $\rightarrow$   &    III   &    V    \\
                \hline
                III    &     17529    &    2498    \\
                \hline
                V    &    854    &   20346    \\
                \hline
            \end{tabular}
            \begin{tabular} {| c | c | c | c |}
                \hline
                Класс    &    Точность   &    Полнота    &    F1-мера     \\
                \hline
                III    &    95\%    &    88\%    &    91\% \\
                V   &   89\%        &   96\%        &   92\%        \\
                \hline
            \end{tabular}
        \end{center}

        Классификатор имеет приемлемое качество. Результат его работы --- наличие класса светимости у всех рассматриваемых звезд.

    \section{Результаты}
        %Примеры кривой покраснения вписывающихся в теоретическую модель. Обсуждение кривой-прямой. Доверительные интервалы по расстоянию и звездной величине покраснения. Линейная модель покраснения (т.к. просто для других моделей недостаточна точность данных). Распределение коэффициента k по небесной сфере. Сравнение полученного распределения с уже известными данными о пылевых облаках, полученными другими методами (В.Ильин – спросить).

        Построение кривых покраснения в разных направлениях позволит нам понять пространственное распределение межзвездного поглощения (пыли). Звезд в каталоге не бесконечное число, поэтому реальные кривые покраснения будут не непрерывными кривыми, а будут наборами точек, описывающими ход покраснения. Аналогично, вместо звезд на луче зрения мы должны использовать звезды в малых конусах. Поэтому, ход покраснения у нас будет выглядеть, к примеру, так,
        \begin{figure}[h]
            \begin{center}
                \includegraphics[width=10cm]{real-1.eps}
                \caption{\rm Покраснение из данных каталога Hipparcos}
                \label{pi_accuracy}
            \end{center}
        \end{figure}

        Следующий метод позволит построить <<кривые>> покраснения во всех направлениях на небесной сфере. Он состоит из трех этапов,
        \subsection{Картирование небесной сферы}
            Для картирования небесной сферы мы воспользуемся стандартным алгоритмом Healpix \cite{healpix}, с помощью которого мы разобьем сферу на достаточно маленькие равновеликие части. Назовем их $\{P_i\}_{i = 1}^{2n^2}$ (у нас $n = 18$). Обозначим конусы, высекаемые соответствующими частями через $\{C_i\}_{i = 1}^{2n^2}$\\
            Такое разбиение позволит нам,
            \begin{enumerate}
                \item Рассмотреть ход покраснения в каждом конусе как одномерную функцию $E(r)$. Это корректно, ввиду того, что конусы достаточно узкие;
                \item Сделать наши результаты <<независимыми>>, т.к. конусы не пересекаются;
                \item Поместить в каждый конус примерно одинаковое число звезд, чтобы избежать недостатка звезд в некоторых конусах.
            \end{enumerate}

        \subsection{Тренд}
            Тем самым, мы ищем $E_i(r)$, соответствующую каждому $C_i$. Ввиду того, что практически все $E_i(r)$ очень сильно зашумлены разного рода ошибками, не удается проследить истинный ход этих функций. Но тренд вида $k r$ все же можно вычислить ($E_i(r) \approx k_i r$). Он находится с помощью метода наименьших квадратов.

        \subsection{Критерии выбора звезд}
            \subsubsection{По параллаксу}
                В каталоге Hipparcos, далекие звезды имеют очень большие ошибки в параллаксе. На расстояниях, скажем, в 400 пк они могут достигать 100\%. Такие ошибки могут очень сильно испортить наши результаты. Тем самым, мы не будем рассматривать звезды, у которых относительная ошибка параллакса не превосходит 25\%. Меньшее значение порога оставит нам очень малое число звезд, которых не хватит для того, чтобы вычисленные тренды были достоверными.
            \subsubsection{По тренду}
                Покраснения некоторых звезд вносят большие ошибки в искомые тренды. Иногда они получаются вообще отрицательными, что противоречит здравому смыслу. Но об этом мы поговорим позже.

                Как известно, метод наименьших квадратов не устойчив к выбросам, т.е. совсем неверные покраснение/параллакс могут очень сильно испортить тренд. Для более устойчивого построения тренда, мы сделаем следующее. После построения тренда по всем звездам в конусе, мы выбрасываем те, у которых отклонение от тренда самое большое. Затем, мы строим тренд заново, но уже только по оставшимся звездам. После выброса 10\% самых плохих звезд тренд, к примеру, может быть таким
                \begin{figure}[h]
                    \begin{center}
                        \includegraphics[width=10cm]{real-2-k.eps}
                        \caption{\rm Тренд покраснения, построенный без учета выбросов}
                        \label{pi_accuracy}
                    \end{center}
                \end{figure}

                В данном случае, мы выбросили одну звезду (синюю). 10\% звезд --- это обычно 0, 1 или 2 звезды в каждом конусе. Опять же, нельзя выбрасывать слишком много звезд из-за опасности <<подгонки>> данных под модель.

        \subsection{Распределение коэффициента $k$}
            Тем самым, ход покраснения в конусе $C_i$ мы описываем одним числом $k_i$ --- скоростью роста покраснения в этом конусе. Она, как мы ранее выясняли,  должна коррелировать с наличием пыли. Поэтому, составив карту распределения коэффициента $k$, мы составим панораму пыли в окрестности Солнца.
            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{map-k-has-lumin.eps}
                    \caption{\rm Распределение градиента покраснения, построенного по звездам, имеющим класс светимости в каталоге}
                    \label{pi_accuracy}
                \end{center}
            \end{figure}
            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{map-k-left.eps}
                    \caption{\rm Распределение градиента покраснения, построенного по звездам с $B-V < 0.6$}
                    \label{pi_accuracy}
                \end{center}
            \end{figure}
            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{map-k-right.eps}
                    \caption{\rm Распределение градиента покраснения, построенного по звездам с $B-V \ge 0.6$}
                    \label{pi_accuracy}
                \end{center}
            \end{figure}
            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{map-k.eps}
                    \caption{\rm Распределение градиента покраснения, построенного по всем звездам}
                    \label{pi_accuracy}
                \end{center}
            \end{figure}

            Это небо в галактической системе координат с центром в центре галактики. Сфера разбита на $12 \cdot 18^2 = 3888$ <<пикселей>> алгоритмом HEALPix. В каждом кусочке построен тренд покраснения $k r$. На этом рисунке изображено распределение значения коэффициента $k$ по пикселям. Синий цвет означает отрицательное значение $k$, красный - положительное. Чем насыщеннее цвет, тем больше значение коэффициента по модулю.

    \section{Отрицательное покраснение}
        %Примеры отрицательного поглощения. 1) Существуют звезды с аномальным значением поглощения: значимое отрицательное приращение к показателю цвета. Случайные отклонения, связанные, например, с необычными спектральными характеристиками. 2) Существуют «картинки», в которых целый ряд звезд имеют неправильное поглощение – систематическая ошибка – попытаться выяснить природу. Таблица наиболее значительных отклонений от нормы. Диаграмма.

        На некоторых площадках коэффициент $k$ отрицательный. В теории, такого не должно быть, т.к. межзвездное поглощение не может делать звезды более голубыми. Пример хода покраснения на одной из площадок,
        \begin{figure}[h]
            \begin{center}
                \includegraphics[width=10cm]{real-4-k.eps}
                \caption{\rm Отрицательный ход покраснения}
                \label{pi_accuracy}
            \end{center}
        \end{figure}
        Мы видим, что это вызвано тем, что некоторые звезды имеют сильно отрицательное покраснение. То есть $E_{B - V} + 3 \sigma_{E_{B - V}} < 0$, где $\sigma$ --- это ошибка. Такого не должно быть, т.к. звезда не может сильно голубеть на расстоянии.
        Давайте рассмотрим какую-нибудь звезду, имеющую такое аномальное отрицательное покраснение. К примеру, HIP 66713. Ее параметры:
        \begin{itemize}
            \item Параллакс $7.99 \pm 0.77$
            \item Показатель цвета $0.386 \pm 0.014$
            \item Спектральный тип G0V
            \item Видимая звездная величина 8.37
        \end{itemize}
        Мы видим, что она не имеет аномальных параметров. Так же, ее параметры имеют небольшие ошибки. Согласно таблице в \cite{tsvetkov}, спектральному типу G0V соответствует показатель цвета $0.580$. Тем самым, покраснение $E = (B - V)_{obs} - (B - V)_{int} = (0.386 \pm 0.014) - 0.580 = -0,194 \pm 0.014$. Мы видим аномальное покраснение у не аномальной звезды.
        И таких звезд (имеющих $E_{B - V} + 3 \sigma_{E_{B - V}} < 0$) 11993 из 94670 (12.6\%), то есть достаточно много. Основные возможные причины таких отклонений --- неверные таблицы <<спектральный тип --- покраснение>>, ошибки в спектральной классификации (см. обучающее множество в <<Способах получения классов светимости>>). Этой проблеме будет посвящена следующая статья.

    \section{Заключение}
        %Получены определенные результаты. Найдены области с большим значением K (красные пиксели). Вопросы: отриц. поглощение – в дальнейшей работе будет проведено исследование.

        Этот раздел еще не создан
        
    \section{Приложение}
        \subsection{Классификация данных методом опорных векторов}
            Задача классификации состоит в том, чтобы определить, к какому классу относится данный объект на основе обучающей выборки --- других объектов, про которые заранее известно, к каким классам они принадлежат. Каждый объект описывается числовыми атрибутами, поэтому задача классификации объектов сводится к задаче классификации точек в $\mathbb{R}^n$. Если классов всего два, то задача называется бинарной классификацией, если несколько —-- мультиклассификацией. 
            
            Задачу классификации на $m$ классов можно сформулировать следующим образом, пусть есть обучающая выборка $(x_i, y_i), x_i \in \mathbb{R}^n, y_i \in \{1, \dots, m\}$. Требуется на основе обучающей выборки построить решающую функцию $F: \mathbb{R}^n \rightarrow \{1, \dots, m\}$, сопоставляющую класс любой точке из $\mathbb{R}^n$. В случае бинарной классификации, классы будет удобно обозначить за $\{-1, 1\}$.
            
            Бинарный классификатор назовем {\it линейным}, если его решающая функция выглядит следующим образом, 
            $$
                F(x) = \sign(w \cdot x + b) = \sign\left(\sum\limits_{i = 1}^n w_i x_i + b\right),
            $$
            где $x_i$ --- компоненты вектора $x$, $b$ --- параметр, $w$ --- вектор, соответствующий нормали к {\it разделяющей гиперплоскости} (ее уравнение $w \cdot x + b = 0$). Классы $\{-1, 1\}$ назовем линейно разделимыми, если существует гиперплоскость, разделяющая точки разных классов по разным полупространствам относительно этой гиперплоскости.
            
            В простейшем случае, метод опорных векторов --- это алгоритм обучения линейного бинарного классификатора методом {\it максимального зазора}. Если классы $\{-1, 1\}$ линейно разделимы, это есть алгоритм нахождения гиперплоскости, которая наилучшим образом разделяет классы. То есть гиперплоскости $(w, b)$, которая находится на максимальном расстоянии до ближайшей точки <<-1>> класса и ближайшей точки <<1>> класса. Можно показать, что такая гиперплоскость будет иметь эти расстояния равными $\frac{1}{\left\| w \right\|}$ --- величине {\it зазора} (рис 13).
            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{svm.eps}
                    \caption{\rm Решение задачи бинарной классификации в $\mathbb{R}^2$ методом опорных векторов}
                    \label{pi_accuracy}
                \end{center}
            \end{figure}            
            Зазор должен быть максимальным, поэтому, для нахождения такой гиперплоскости требуется максимизировать $\frac{1}{\left\| w \right\|}$, то есть минимизировать $\left\| w \right\|^2$. Тем самым, метод опорных векторов сводится к решению следующей задачи,
            $$
                \left\{
				    \begin{array}{l}
					    \left\| w \right\|^2 \rightarrow \min 	\\
					    \sign(w \cdot x_i + b) = y_i
				    \end{array}
			    \right.
			$$	
			где второе условие соответствует линейной разделимости обучающей выборки. Перепишем, 
			$$
                \left\{
				    \begin{array}{l}
					    \left\| w \right\|^2  \rightarrow \min  	\\
					    y_i (w \cdot x_i + b) \ge 1
				    \end{array}
			    \right.
			$$	
			что есть задача квадратичного программирования, которая решается с помощью множителей Лагранжа. 
			
			Для того, чтобы алгоритм мог работать в случае, если классы линейно неразделимы, позволим ему допускать ошибки на обучающей выборке. Введем набор дополнительных переменных $\xi_i \ge 0$, характеризующих величину ошибки на точках $x_i$. Смягчим ограничения в неравенствах и введем в минимизируемый функционал штраф за суммарную ошибку,
            $$
                \left\{
				    \begin{array}{l}
					    \frac{1}{2} \left\| w \right\|^2 + C \sum_i \xi_i \rightarrow \min  	\\
					    y_i (w \cdot x_i + b) \ge 1 - \xi_i    \\
					    \xi_i \ge 0
				    \end{array}
			    \right.
			$$		
			Где $C$ --- параметр настройки метода. Опять же, получилась задача квадратичного программирования. Эффективно такая задача может решаться такая с помощью метода <<Sequential Minimal Optimization>> (SMO) \cite{smo}.
			
	    \subsection{Кросс-валидация, оценка качества работы классификатора}
	        Для получения несмещенной оценки качества работы аналитической модели проводится {\it кросс-валидация}. Она заключается в том, что обучающая выборка дизъюнктно делится на две части --- тренировочное множество и тестовое множество, затем модель обучается на тренировочном множестве, а оценка качества работы получается на тестовом. Одним из способов проведения кросс-валидации является k-fold кросс-валидация. В этом случае обучающая выборка разбиваются на $k$ частей, затем на $k - 1$ части выборки производится обучение модели, а оставшаяся часть используется для тестирования. Процедура повторяется $k$ раз, в итоге каждая из $k$ частей используется в качестве тестовой. В результате получается оценка эффективности выбранной модели с наиболее равномерным использованием имеющихся данных. 
	        
	        Для задачи классификации на $m$ классов, результатом кросс-валидации является таблица $m \times m$, в ячейке $i, j$ которой записано число объектов класса $i$ из тестового множества, про которые классификатор считает, что они принадлежат классу $j$. В случае k-fold кросс-валидации итоговая таблица $m \times m$ есть сумма всех $k$ таблиц, полученных из обучения + тестирования классификатора на каждом из $k$ разбиений на тренировочное и тестовое множество.
            
            По полученной таблице $C[m, m]$ можно считать различные метрики --- числа, характеризующие качество классификации,
            \begin{itemize}
                \item {\it Точность} определения класса $i$ --- $\frac{C_{ii}}{\sum\limits_{j = 1}^m C_{ji}}$
                \item {\it Полнота} определения класса $i$ --- $\frac{C_{ii}}{\sum\limits_{j = 1}^m C_{ij}}$
                \item {\it $F_1$-мера} определения класса $i$ - среднее гармоническое точности и полноты определения класса $i$
            \end{itemize}
	

    \begin{thebibliography}{1}
        \bibitem{hipparcos} van Leeuwen, F. {\em Validation of the new Hipparcos reduction}  2007: Astronomy and Astrophysics
        \bibitem{tycho} Wright et al. {\em Tycho-2 Spectral Type Catalog} 2003: The Astronomical Journal
        \bibitem{strigest} Страйджест – книжка
        \bibitem{tsvetkov} А.А.Сминов, А.С.Цветков, А.В.Попов {\em Неточности в спектальной классификации звезд каталога Tycho-2 Spectral Type} 2006.
        \bibitem{goncharov} Гончаров
        \bibitem{svm} V.N.Vapnik {\em The Nature of Statistical Learning Theory} 1995.
        \bibitem{smo} Trevor Hastie et al. {\em The Elements of Statistical Learning}
        \bibitem{healpix} Gorski et al. {\em HEALPix: A Framework for High-Resolution Discretization and Fast Analysis of Data Distributed on the Sphere} 2005.
    \end{thebibliography}
\end{document}
