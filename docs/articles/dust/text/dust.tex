\documentclass[16]{article}
%\documentclass[14pt]{article}
\usepackage[cp1251]{inputenc}
\usepackage[english,russian]{babel}
\inputencoding{cp1251}
\usepackage{graphicx}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{indentfirst}
\usepackage{epsfig}
\usepackage{ccaption}
\usepackage{amsmath}
\DeclareMathOperator{\sign}{sign}

\textwidth 16.5cm
\textheight 22cm
\voffset=-1.4cm
\hoffset=-2.3cm

\author{Ф.Амосов}
\title{\bf Определение параметров межзвездного поглощения света по данным каталога Hipparcos}

\begin{document}
    \maketitle

    \begin{abstract}
        Основная задача исследования –- построение метода автоматического поиска пылевых облаков в окрестности Солнца на основе массовых каталогов звезд. На первом этапе метод был применен к данным каталога Hipparcos, а именно
        для построения двумерной панорамы распределения пылевых облаков на небесной сфере.
        Метод исследования основан на сравнении эталонного показателя цвета звезды данного спектрального класса с наблюдаемым показателем цвета.
        Так как полная двумерная спектральная классификация известна не для всех звезд каталога Hipparcos,
        была решена вспомогательная задача: используя параллаксы звезд каталога Hipparcos дополнить информацию о
        звездах классом светимости на основе данных о видимой звездной величине и параллаксе звезды.
        В результате работы была построена карта распределения пылевой материи, вызывающей покраснения света звезд, на небесной сфере.
        Недостаточная плотность звезд и низкие относительные точности параллаксов для далеких звезд не позволяют полностью использовать возможности метода,
        которые будут полностью раскрыты по завершении миссии GAIA
   \end{abstract}

    \section{Введение}
        %Постановка задачи. Общая задача – 3D, будет возможна после GAIA. Частная задача. Полстраницы

        Общая задача поиска облаков межзвездной пыли, ответственной за поглощение света звезд, является трехмерной.
        Для ее надежного выполнения необходим массовый каталог параллаксов звезд. На сегодняшний день таким каталогом является Hipparcos,
        но, как мы увидим, его точности недостаточно для решения этой задачи. Видимо её полное решение будет возможно только
        после получения результатов миссии GAIA, чьей основной задачей является определение структуры Млечного Пути в окрестности Солнца.
        Поэтому мы представим решение частной задачи -- задачи построения двумерного распределения пыли по небесной сфере.
        Ее решение позволит по крайней мере определить направления наибольшего поглощения и изменения таких характеристик звезд как звездная величина и
        показатель цвета
        Это позволит в будущем учитывать межзвездное поглощение при определении характеристик звезды таких как, к примеру, показатель цвета.


%===========

%ЗАМЕТКИ 09.04.2015

%Цитата  из [KH1]: ([KH1] Astron. Astrophys. 338, 897–904 (1998) ASTRONOMY AND ASTROPHYSICS Interstellar
%reddening from the Hipparcos and Tycho catalogues I. Distances to nearby molecular clouds and star forming
%regions J. Knude and E. Hog )

% The spectral and luminosity classification are entirely from the literature.
%Metallicity information is generally not available but luminosity classification is available for about a
%third of the entries in the Hipparcos Catalog (nearly 35.000 stars are classified as LC V and III)

%Итак, в каталоге HIPPARCOS имеется 35000 звезд, для которых есть информация о классах светимости. Именно с
%ними работали авторы работы [KH1]. ЦЕЛЕСООБРАЗНО ПРИВЕСТИ  РАСПРЕДЕЛЕНИЕ  ЭТИХ ЗВЕЗД ПО СФЕРЕ (АНАЛОГ РИС.
%2).

%По-видимому, рис. 2 отображает структуру обучающего множества. Так, или нет?

%Нужно описать структуру обучающего множества, то есть указать, сколько и каких звезд в нем из каталога
%HIPPARCOS, а сколько из Tycho 2 Spectral Type.


%Поэтому в соответствующем месте вот этот текст

%=========

%        В качестве обучающего множества возьмем все звезды, у которых присутствует класс
%        светимости в каталоге
%        (КАКОМ?),
%        и он либо III, либо V.

 %        Таких звезд $41227$ ($20027$ III класса, $21200$ V класса).

%        {\it ЧИСЛО ЗВЕЗД, У КОТОРЫХ ПОКАЗАТЕЛЬ ЦВЕТА МЕНЕЕ 0.6 РАВНО 18016 --- 2455 III КЛАССА, 15561 V КЛАССА}

%        {\it ЧИСЛО ЗВЕЗД, У КОТОРЫХ ПОКАЗАТЕЛЬ ЦВЕТА НЕ МЕНЕЕ 0.6 РАВНО 23211 --- 17572 III КЛАССА, 5639 V КЛАССА}

%================

%оформите в виде легко читаемой таблички, указав в ней и источник (из какого каталога сколько)

%Теперь о Вашем ответе в подписи к рис. 8. На самом деле, в каталоге HIPPARCOS есть 35 000 звезд (см.
%выше), для которых известны параллаксы, классы светимости и B-V.  Поэтому МОЖНО построить аналог рис. 8
%только по каталогу HIPPARCOS.



    \section{Исходные данные}
        %Каталог Hipparcos – приводите сведения о точности параллаксов, особенно об относительной точности расстояний. Диаграмма «относительная точность от расстояния». Фотометрия. Bt Vt и связь ее с B-V классической. В каталоге Hip 2007 приведены данные B-V. Спектральная классификация. Наличие двумерной спектральной классификации. Картинка о наличии классов светимости.

        \subsection{Общие сведения о каталоге Hipparcos}
            В 1989 году Европейское Космическое Агентство (ESA) осуществило запуск космического аппарата HIPPARCOS (HIgh Precision PARallax COllecting Satellite --- <<спутник для сбора высокоточных параллаксов>>) с целью получения положений, собственных движений и параллаксов звезд на миллисекундном уровне точности.  Космический аппарат проработал на орбите 37 месяцев, в течение которых он выполнял астрометрические и фотометрические измерения звезд по заданной программе. Обработка этих наблюдений привела к созданию двух каталогов: Hipparcos\cite{hipparcos}, содержащего информацию о 118218 звездах с точностью определения положений, годичных собственных движений и параллаксов на уровне 1 mas (milli arc second), и каталога Tycho\cite{tycho}, содержащего уже свыше 1 млн. звезд, с точностью измерения тех же параметров до 25 mas.

            Положения и собственные движения звезд в Hipparcos приводятся в фундаментальной системе ICRS (International Celestial Reference System), реализованной в настоящее время с помощью каталога внегалактических радиоисточников, получившего название ICRF (International Celestial Reference Frame).  Следует отметить, что достигнутая точность привязки осей координат системы отсчета каталога HIPPARCOS к осям ICRF оценивается величиной  0.6 mas по всем трем углам поворота и величиной 0.25 mas/год по всем трем компонентам  вектора остаточного взаимного вращения двух систем отсчета.

            В 2007 году вышла новая редакция астрометрических данных каталога Hipparcos \cite{hipnewcat} --- каталог HIPNEWCAT (HIPparcos NEW astrometric CATalog). Утверждается, что точность положений, параллаксов и собственных движений всех звезд, ярче $H_P = 8$, улучшена в 4 раза, а для всех остальных звезд более, чем в 2 раза. Уменьшена взаимная корреляция параметров иногда в 10 раз. Именно эта версия использовалась в работе в качестве источника астрометрических данных.

        \subsection{Фотометрические системы каталогов Tycho и Hipparcos}
            Фотометрические измерения на основном инструменте спутника HIPPARCOS выполнялись в широкой полосе (обозначаемую как $H_P$). В дополнение, почти для всех звезд каталога была выполнена двухцветная фотометрия (фотометрия Tycho величины $V_T$ и $B_T$). Точность определения $H_P$ составляет $0.0004^m - 0.007^m$ (для звезд $2-12^m$), а точность одного измерения --- $0.003^m - 0.05^m$.

            Фотометрические системы  $H_P$, $V_T$ и $B_T$ --- это инструментальные системы, и они не совпадают с общепринятой системой Джонсона. Используя значения звездной величины $V_J$ по шкале Джонсона и показателя цвета  для 8000 стандартных звезд с хорошими фотометрическими данными в системе $B_T$ и $V_T$, были получены следующие эмпирические линейные соотношения, применимые к диапазон $-0.2 < (B - V)_T < 1.8$:
            $$ V_J = V_T - 0.090 (B - V)_T $$
            $$ (B - V)_T = 0.850 (B - V)_T $$
            Точность этих преобразований в среднем лучше, чем $0.015^m$ для $V_J$ и $0.05^m$ для $(B - V)_T$. Эти преобразования применимы к звездам, чей цвет не искажен межзвездным поглощением, и игнорируют зависимость от класса светимости. Формулы вообще не применимы к звездам класса M, даже если их показатель цвета  $(B - V)_T < 1.8^m$.

       %%%% \subsection{Распределение звезд по абсолютной звездной величине}
%%%%            Измерения блеска звезд в двух полосах $B_T$, $V_T$ были сделаны для $114820$ звезд в Hipparcos, кроме этого для $2117$ звезд фотометрические данные были взяты из наземных источников. Для $115180$ звезд имеются данные и о спектральном классе. Индивидуальные параллаксы позволяют вычислить абсолютную звездную величину или светимость для каждой звезды.
%%%%
%%%%        \subsection{Диаграмма Герцшпрунга-Рессела}
%%%%            Каталог Hipparcos дает уникальную возможность построить диаграмму для любой выборки звезд. До появления этого каталога это было невозможно из-за плохого знания расстояний. Диаграммы удавалось строить только для тех звезд, для которых имелась косвенная информация, что они находятся от нас примерно на одинаковом расстоянии, например, для звезд одного звездного скопления. Рис. \ref{pic2-3} показывает диаграмму Герцшпрунга-Рессела для звезд, ближе 100 пк, у которых относительные ошибки определения параллаксов не будут превышать $10\%$.
%%%%            \begin{figure}[h]
%%%%                \begin{center}
%%%%                    \includegraphics[width=7cm]{pic2-3.eps}
%%%%                    \caption{\rm Диаграмма Герцшпрунга-Рессела для звезд ближе 100 пк на основе данных каталога Hipparcos}
%%%%                    \label{pic2-3}
%%%%                \end{center}
%%%%            \end{figure}

        \subsection{Спектральные характеристики звезд}
            Каталог Hipparcos для большинства звезд содержит информацию
            о спектральном типе, полученную из наземных наблюдений.
            Основной источник -- Мичиганский каталог
            (Michigan catalogue for the HD stars, vol. 1-4, (Houk+, 1975-1988)) и
            несколько других источников.
            %Диаграмма Герцшпрунга-Рессела, в которой по горизонтальной оси отложен спектральный класс, а не показатель цвета, показывает весьма размытую картину, что указывает на значительные неточности в спектральных классах звезд.
            Однако, информация о спектральных классах приведена только для звезд
            южного экваториального полушария (рис.\ref{has-lumin}).
            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{has-lumin.eps}
                    \caption{\rm Распределение звезд на небесной сфере, для которых в каталоге HIPPARCOS
                    имеются сведения о классе светимости.
                    Чем больше в пикселе доля звезд, имеющих класс светимости, тем он краснее.
                    Видим отсутствие класса светимости практически у всех звезд
                    северного экваториального полушария.}
                    \label{has-lumin}
                \end{center}
            \end{figure}



        \subsection{Используемые данные}
 В каталоге Hipnewcat отсутствуют спектральные данные,
            поэтому в данной работе они были взяты из каталога Hipparcos.
            Также из каталога Hipparcos были взяты значения видимой
            звездной величины V.
            Итак, мы рассматривали только те звезды, которые имеют данные
            о положении, параллаксе в Hipnewcat и данные о
             спектральном типе и видимой звездной величине в Hipparcos.
             Кроме того, мы не рассматривали звезды, у которых в
             каталоге Hipnewcat указано число компонент более одной.
             Число звезд, используемых в данной работе получилось равным $98827$.

Таким образом, в нашей работе использовалась следующая информация:

            \begin{itemize}
                \item положения звезд  (каталог Hipnewcat)
                \item параллаксы звезд  (каталог Hipnewcat)
                \item фотометрия ($V_{mag}$ - каталог Hipparcos)
                \item  класс светимости (каталог Hipparcos)
            \end{itemize}


            %%%Для определения параметров межзвездного поглощения, необходимо иметь следующие данные о звездах,
%%%            \begin{itemize}
%%%                \item положение
%%%                \item параллакс
%%%                \item фотометрия
%%%                \item спектральный класс и класс светимости
%%%            \end{itemize}
%%%            В каталоге Hipnewcat отсутствуют спектральные данные, поэтому в данной работе они были взяты из каталога Hipparcos. Так же из Hipparcos были получены значения видимой звездной величины $V_{mag}$. Итак, мы рассматривали только те звезды, которые имеют данные о положении, параллаксе, покраснении в Hipnewcat и данные о спектральном типе и видимой звездной величине в Hipparcos. Кроме того, мы не рассматривали звезды, у которых в каталоге Hipnewcat указано число компонент более одной. Число звезд, используемых в данной работе получилось равным $98827$.

            %\subsubsection{Параллакс}
                %Звезды в каталоге Hipparcos имеют низкую точность параллакса. Это можно видеть из следующей гистограммы. На ней отложены средние значения относительной ошибки в расстоянии для звезд на  разных расстояниях.
                %\begin{figure}[h]
                    %\begin{center}
                        %\includegraphics[width=10cm]{r-r_rel.eps}
                        %\caption{\rm Относительная ошибка в расстоянии от расстояния}
                        %\label{pi_accuracy}
                    %\end{center}
                %\end{figure}
                %Мы видим что, например, на расстоянии в 500 пк ошибка в параллаксе достигает 50\%.
            %\subsubsection{Положение}
                %Ошибки в положении звезд на небе на порядок меньше ошибок в параллаксе, поэтому их можно не учитывать, если нас интересует пространственное распределение звезд.


    \section{Покраснение}
        %Основное уравнение Obs – Int. Обсуждение уравнения: примеры за и против.  Необходимые данные для получения табличных значений показателя цвета звезды: Sp и класс светимости. «Отрицательное покраснение»: где и когда встречаются. Ссылки на уже обнаруженные несоответствия. Влияние пылевой материи на покраснение и ослабление блеска звезд. Теоретическая кривая покраснения в некотором направлении. Интерпретация кривой. Этот раздел должен быть не слишком мал.


        \subsection{Определение}
            Межзвездное поглощение может быть описано избытком цвета.
            Избыток цвета мы будем называть <<покраснением>>. {\it Покраснение} звезды есть
            \begin{equation}
                \label{E} E = E_{B - V} = (B - V)_{obs} - (B - V)_{int},
            \end{equation}

            \noindent где $(B - V)_{obs}$ --- ее видимый  показатель цвета звезды (с учетом межзвездного поглощения),
            а $(B - V)_{int}$ --- теоретический показатель цвета звезды (без учета межзвездного
            поглощения).
            Значение $(B - V)_{obs}$ мы можем получить на основе данных фотометрии звезды из каталога.
В таблице \ref{int} приведены значения абсолютной звездной величины $M_V$ и $(B - V)_{int}$ и спектральный
класс, взятые из работы \cite{binney}.
     %%%        В таблице  показаны используемые нами величины $(B - V)_{int}$ приведены в таблице, используемые нами, приведены  в    оцениваются статистически.
%%%             В нашей работе  мы воспользуемся приведенной в \cite{tsvetkov}
%%%             двумерной таблицей <<спектральный класс, класс светимости --- показатель цвета>>.
             То есть, для получения $(B - V)_{int}$ звезды нам  нужно знать  ее
              спектральный класс и класс светимости.



               Приведем пример расчета покраснения на звезде HIP 44800,
                \begin{itemize}
                    \item У нее в каталоге $(B - V)_{obs} = 0.535^m$
                    \item Класс F7V, поэтому (по \cite{tsvetkov}) $(B - V)_{int} = 0.493^m$
                    \item Покраснение $0.535^m - 0.493^m = 0.042^m$
                \end{itemize}

%=========

%                ВОПРОС: ОТКУДА ВЗЯТЫ ЭТИ ДАННЫЕ?

%==========

%                {\it ИЗ Hipnewcat + Hipparcos}

%=============

                Покраснение --- это количественное измерение межзвездного поглощения,
                поэтому мы можем сказать, что <<между нами и звездой HIP 44800 пыли на $0.042^m$>>.



    \section{Способ получения классов светимости}
        %%%%Из каталога (Tycho 2 Sp Types в Hipparcos 2007).
%%%        Здесь можно рассказать о достоинствах метода автоматического обучения.
%%%        Обучащающее множество.
%%%        Качество классификации. III и V классы светимости.
%%%        Картинки. Результаты дополнения каталога классами светимости.

        Как мы увидели в обзоре данных каталога Hipparcos, практически у всех звезд
        северного экваториального полушария отсутствует класс светимости.
         Для нас его наличие чрезвычайно важно, ввиду того,
         что мы на основе класса светимости и спектрального класса рассчитываем
         истинное значение $B - V$ для звезд $(B - V)_{int}$.
          Тем самым, отсутствие класса светимости у половины звезд
          делает невозможным проведение наших расчетов для всего
          северного экваториального полушария.

        Для исправления этого недостатка используем  метод машинного обучения. Натренируем классификатор,
         который будет определять класс светимости для звезды по двум факторам --- ее
         показателю цвета $B-V$ и ее абсолютной звездной величине $M_V$. Этих факторов должно быть
         достаточно, т.к. классы светимости теоретически разделимы на диаграмме Герцшпрунга-Рессела.

        В каталоге HIPPARCOS доля звезд, которые  не относятся  ни к III, ни к V классам  светимости
        мала (16,3\%, 8058 из 49285).
        Поэтому, мы упростим задачу --- обучим линейный бинарный классификатор, который
        будет предсказывать III или V класс.
        Сделаем это с помощью метода опорных векторов \cite{svm}, основные положения
        которого приведены в Приложении.

        В качестве обучающего множества возьмем все звезды, у которых присутствует
        класс светимости  III и  V. %В конце 2 главы мы рассказали, с какими звездами работаем и откуда у них какие данные
        Таких звезд $39807$. Распределение этих звезд по классам светимости
        показно  в  таблице   \ref{dataset}:


        \begin{table}[t!] \centering
                \caption {Структура обучающего множества}\label{dataset}
            \begin{tabular} {| c | c | c | c |}
                \hline
                класс светимости   &    $B - V < 0.6$ & $B - V \ge 0.6$    &    всего    \\
                \hline
                III    &    1947    &    16681    &    18628   \\
                \hline
                V    &    15549    &    5630    &    21179    \\
                \hline
                III \& V    &    17496    &    22311    &    39807    \\
                \hline
                \end{tabular}
                \end{table}

Диаграмма Герцшпрунга-Рессела, соответствующая нашему обучающему множеству, показана на рис.
\ref{classify}, а карта звезд этого множества --- на рис. \ref{map-dataset}.


        \begin{figure}[h!]
            \begin{center}
                \includegraphics[width=10cm]{classify.eps}
                \caption{\rm Диаграмма Герцшпрунга-Рессела обучающего множества звезд (табл.
                \ref{dataset}). Разделяюшая линия --- зеленый цвет, теоретические кривые для III  и V классов
                светимости показаны голубым  и желтыми цветами ссответственно.}
                \label{classify}
            \end{center}
        \end{figure}



         \begin{figure}[h!]
            \begin{center}
                \includegraphics[width=10cm]{main-lumin.eps}
                \caption{\rm Распределение звезд  обучающего множества по небесной сфере.
                Отличие от рис.(\ref{has-lumin})
                в том, что здесь показаны звезды только III и V классов светимости.}
                \label{map-dataset}
            \end{center}
        \end{figure}


        Результатом обучения  классификатора является  разделяющая классы прямая, уравнение которой
 имеет следующий вид:
\begin{equation}\label{class-line}
    F(B - V, M) = -2.9876 \cdot (B - V) + 0.4526 \cdot M + 1.3547 = 0,
\end{equation}


        \noindent где $B - V$ -- показатель цвета, $M$ -- абсолютная звездная величина.

        Мы видим, что при показателе цвета $B-V \ge 0.6$ классификатор
        работает практически идеально, но при $B-V < 0.6$  и $F(B - V, M) > 0$ он всем звездам
         предсказывает V класс при большой доле звезд III класса в обучающем множестве
%         (10.3\%, 1758 из 17029).
         (11.1\%, 1947 из 17496).
         При $B - V < 0.6$ звезды III и V класса неразделимы, поэтому для
         этой половины можно принять другое решение --- результат
         работы классификатора будет взвешенным средним III и V классов,
         то есть некоторым средним классом, $(B - V)_{int}$, у которого будет равен

\begin{equation}\label{w1w2}
    (B - V)_{int} = w_1 \times (B - V)_{int} (III) + w_2 \times (B - V)_{int} (V).
\end{equation}


        В этой формуле веса $w_1$ и $w_2$,  ($w_1 + w_2 = 1$) логично взять в соответствии
        с априорной вероятностью классов в этой области (0.11 и 0.89).

        В таблице двумерной спектральной классификации \cite{tsvetkov}
         у спектрального типа G2 показатель цвета при III классе 0.733,
         при V --- 0.630. Это максимальная разница между III и V классом в интересующем нас диапазоне.
          Класс, соответствующий средневзвешенному решению будет иметь показатель цвета

\begin{equation}\label{w1w2_res}
    (B-V)_{int} = 0.11 \cdot 0.733 + 0.89 \cdot 0.630 = 0.64.
\end{equation}


        Как мы видим, даже в наихудшем случае отличие от V класса минимальное --- $0.01^m$ --- гораздо
        ниже уровня  ошибок показателя цвета в каталоге HIPPARCOS. Поэтому в дальнейшем мы всегда будем
        использовать решение классификатора в этой области по V классу.

        %ЗАМЕЧАНИЕ. Эти рассуждения можно применять только в процессе кросс-валидации, когда известны
        %пропорции звезд III класса  V класса в выборках, то есть когда можно назначить веса. При реальной
        %работе классификатора мы не знаем пропорций звезд в тестируемом множестве. Поэтому реальное
        %покраснение  $E$ испытуемой звезды лежит в пределах

        %                               $$E_V < E < E_{III},$$
        %где границы диапазона определяются по формуле (\ref{E}). Так как у нас нет никакой инфомации о
        %преобладающей близости величины $E$ к одной из границ диапазона, то естественно принять в качестве
        %оценки искомого покраснения середину промежутка

        %$$E = \frac{1}{2} ( E_V + E_{III}),  (*) $$

        %с очевидной оценкой погрешности такого приближения

        %$$|\Delta E|\le \frac{1}{2} ((B-V)_{int}(III)- (B-V)_{int}(V))$$.

        %Для спектрального класса G2 теперь имеем оценку погрешности покраснения, которую дает
        %классификатор.

       %                     $$|\Delta E|\le 0.052$$

%Из рисунка \ref{classify} видно, что обе границы для покраснения можно получить только до $B-B<0.4$.
%Поэтому оценку покраснения следует вести следующим образом:

%1. До $B-V<0.4$ - по формуле (*)

%2. При  $0.4<B-V<0.6$ только по V классу

%3. При  $ B-V>0.6$  по III или V классу по указаниям классификатора.



                            %ЭТУ ОЦЕНКУ НАДО СРАВНИТЬ С ТОЧНОСТЬЮ ФОТОМЕТРИИ!!!

                           % {\it Тем не менее так делать неправильно. Мы обучаем классификатор именно для нашего датасета, а в нем априорная вероятность появления звезды III класса в этой области равна 12.7\%. На таком подходе и строится все машинное обучение. Мы не можем обучить классификатор, который будет работать в общем случае. Обученная модель работает только в той области, где наше обучающее множество является репрезентативной выборкой. Поэтому мы не имеем права ставить классам веса 50/50 --- получится классификатор не для нашей задачи, не для нашего датасета, а для чего-то странного}


        С учетом этого соглашения проведем  оценку качества работы классификатора
        с помощью процедуры  10-fold кросс-валидации (см. Приложение).
        %(ОБЪЯСНИТЬ!) {\it В ПРИЛОЖЕНИИ ЭТО ДЕЛАЕТСЯ}.
%%%%k-fold cross-validation. In k-fold cross-validation, the original sample is randomly partitioned into k
%%%%equal size subsamples. Of the k subsamples, a single subsample is retained as the validation data for
%%%%testing the model, and the remaining k - 1 subsamples are used as training data. The cross-validation
%%%%process is then repeated k times (the folds), with each of the k subsamples used exactly once as the
%%%%validation data. The k results from the folds can then be averaged (or otherwise combined) to produce a
%%%%single estimation. The advantage of this method over repeated random sub-sampling (see below) is that all
%%%%observations are used for both training and validation, and each observation is used for validation
%%%%exactly once. 10-fold cross-validation is commonly used,[6] but in general k remains an unfixed parameter
%%%Перекрёстная проверка (англ. Cross-validation) — метод оценки аналитической модели и её поведения на
%%%независимых данных. При оценке модели имеющиеся в наличии данные разбиваются на k частей. Затем на k-1
%%%частях данных производится обучение модели, а оставшаяся часть данных используется для тестирования.
%%%Процедура повторяется k раз; в итоге каждая из k частей данных используется для тестирования. В результате
%%%получается оценка эффективности выбранной модели с наиболее равномерным использованием имеющихся данных.
Полученные оценки  параметров классификатора (полнота, точность и F1-мера) приведены в следующей таблице:
\\
\\
        \begin{center}
            \begin{tabular} {| c | c | c | c |}
                \hline
                Решение классификатора $\rightarrow$   &    III   &    V    \\
                \hline
                III    &    16636    &    1992    \\
                \hline
                V       &    783    &    20396    \\
                \hline
            \end{tabular}
            \begin{tabular} {| c | c | c | c |}
                \hline
                Класс    &    Точность   &    Полнота    &    F1-мера     \\
                \hline
                III      &    95\%   &   89\%    &    92\%     \\
                \hline
                V        &    91\%   &    96\%    &    93\%        \\
                \hline
            \end{tabular}
        \end{center}

        Как видим, классификатор имеет приемлемое качество.
        Результатом его работы  является назначение класса светимости  для испытуемой звезды
        с известными значениями $B-V$  и $M_V$.

    \section{Градиент покраснения по расстоянию}
        %%%%Примеры кривой покраснения вписывающихся в теоретическую модель. Обсуждение кривой-прямой.
%%%        Доверительные интервалы по расстоянию и звездной величине покраснения.
%%%        Линейная модель покраснения (т.к. просто для других моделей недостаточна точность данных).
%%%        Распределение коэффициента k по небесной сфере.
%%%        Сравнение полученного распределения с уже известными данными о пылевых облаках,
%%%        полученными другими методами (В.Ильин – спросить).

        \subsection{Идеальная кривая покраснения}
            Предположим, что на некотором луче зрения бесконечно много звезд,
            и они расположены на нем всюду плотно.  Пусть для каждой звезды мы можем идеально
            измерить ее покраснение. Тогда, ход покраснения на этом луче
            зрения должен иметь  вид, показанный на рис.~\ref{red_curve} красной линией.
            \begin{figure}[h!]
                \begin{center}
%                    \includegraphics[width=8cm]{ideal-1-no-tick.eps} \hspace{1}
                    \includegraphics[width=7cm]{ideal-2-no-tick.eps}
                    \caption{\rm Идеальный ход покраснения на луче зрения.
                    По оси $x$ отложено расстояние по лучу зрения,
                    а по $y$ --- покраснение у соответствующих звезд.}
                    \label{red_curve}
                \end{center}
            \end{figure}
            Покраснение должно всегда монотонно расти, т.к. пыль присутствует всюду.
            Очевидно, что там, где покраснение растет быстрее - пыли больше,
             там где медленнее - меньше. Поэтому, можно сказать,
             что облака на этом луче зрения находятся там,
             где покраснение растет <<очень быстро>> (синие области на рис.\ref{red_curve}).

%%%%            \begin{figure}[h!]
%%%%                \begin{center}
%%%%                    \includegraphics[width=8cm]{ideal-2-no-tick.eps}
%%%%                    \caption{\rm Облака на идеальной кривой покраснения}
%%%%                    \label{clouds}
%%%%                \end{center}
%%%%            \end{figure}

            Тем самым, построение кривых покраснения в разных направлениях
            на небе может позволить находить области повышенного мезвездного поглощения,
            то есть находить пылевые облака.


       Как было сказано выше, для каждой звезды, у которой   известны видимый показатель цвета (B-V)
       и класс светимости, можно вычислить покраснение. Если  для всех таких звезд  известны
          еще и их пространственные координаты с хорошей точностью,
          то мы можем говорить о пространственном распределении покраснения звезд, то есть о функции
          $E=E(r)$.     Ввиду того, что практически все значения $E(r)$ очень сильно
            зашумлены разного рода ошибками, не удается проследить
            истинный ход этих функций. Поэтому приходится ограничиться  линейной функцией
            $E(r)=kr+b$, параметры которой можно оценить методом наименьших квадратов.
Таким образом, в данной работе ход покраснения  по лучу зрения моделируется линейной функцией  $kr + b$,
        а основной результат работы заключается в вычислении трендов покраснения звезд $k$ в различных
        направлениях.


        Построение кривых покраснения в разных направлениях позволит нам понять
        пространственное распределение межзвездного поглощения (пыли).
        Звезд в каталоге не бесконечное число, поэтому реальные кривые
        покраснения будут не непрерывными кривыми, а будут наборами точек,
        описывающими ход покраснения. Аналогично, вместо звезд на луче зрения мы
        должны использовать звезды в малых конусах. Поэтому, ход покраснения у
        нас будет выглядеть, к примеру, так, как показано на рис. \ref{red}.
        \begin{figure}[h]
            \begin{center}
                \includegraphics[width=10cm]{real-1.eps}
                \caption{\rm Ход покраснения звезд по расстояниям в направлении
                 $l=5^\circ.00,  b= 24.04^\circ$.  По горизонтали расстояния в пк, по вертикали --- покраснение
                 (зв. вел.). Данные из каталога  Hipparcos}
                \label{red}
            \end{center}
        \end{figure}

\section{Карты градиентов покраснения звезд}

    %%% В нашей работе мы будем использовать  метод получения градиентов покраснения во всех
%%%         направлениях на небесной сфере, состоящий из трех.
%%%
%%%
%%%\subsection{Картирование небесной сферы}
            В данной работе все изображения неба  даются в проекции Хаммера-Айтофа.
            для галактической системы координат.
            Центр изображения --- центр галактики,
            сверху --- северный галактический полюс,
            снизу --- южный галактический полюс, увеличение
            галактических долгот справа налево. Небесная
            сфера разбита на <<пиксели>> стандартным алгоритмом HEALPix \cite{healpix}.
             Ключевым параметром (resolution parameter) алгоритма,
             определяющим разбиение сферы на равные площадки,
             является число $N_{side}$. Общее число пикселей
             $N_{pix} = 12 N_{side}^2$. Двумя параллелями со
              склонениям $\pm \arcsin(2/3)$ вся сфера разбивается
               на три части --- экваториальную и две полярные.
               В полярных зонах выбирается по $N_{side} - 1$ параллелей,
                в экваториальной зоне число параллелей равно $(2 N_{side} + 1)$.
                 На каждой параллели экваториальной области находятся центры  $4 N_{side}$ площадок.
                  Ближайшие к полюсам параллели всегда содержат по четыре площадки,
                  а при движении от полюсов к экватору в полярных зонах число площадок
                  на каждой параллели увеличивается на единицу.
                  Нумерация площадок $i = 0, \dots, N_{pix} - 1$ идет по параллелям с севера на юг.
              В дальнейшем мы будем обозначать площадки, соответствующие <<пикселям>> разбиения
             как $\{P_i\}_{i = 1}^{N_{side}}$, а конусы, высекаемые соответствующими пикселями, ---
              через $\{C_i\}_{i = 1}^{N_{side}}$.
              (У нас $N_{side} = 18$).

            Такое разбиение позволит нам
            \begin{enumerate}
                \item рассмотреть ход покраснения в каждом конусе как
                одномерную функцию $E(r)=kr+b$. Это корректно, ввиду того, что конусы достаточно узкие;
                \item сделать наши результаты <<независимыми>>, т.к. конусы не пересекаются;
                \item поместить в каждый конус примерно одинаковое
                число звезд, чтобы избежать недостатка звезд в некоторых конусах.
            \end{enumerate}

\subsection{Вычисление тренда}
            Как было сказано выше, мы моделируем покраснение звезд вдоль луча зрения линейной функцией
            $E(r)=kr+b$ и ищем параметры этой модели,  соответствующие каждому  конусу $C_i$
            с помощью метода наименьших квадратов. При этом мы используем следующие критерии отбора звезд.

             \subsubsection{Отбор звезд по параллаксу}
                В каталоге Hipparcos, далекие звезды имеют очень большие ошибки в параллаксе.
                На расстояниях, скажем, в 400 пк они могут достигать 100\%.
                Такие ошибки могут очень сильно испортить наши результаты.
                Тем самым, мы не будем рассматривать звезды, у которых относительная ошибка
                параллакса не превосходит 25\%.
                 Меньшее значение порога оставит нам очень малое число звезд,
                 которых не хватит для того, чтобы вычисленные тренды были достоверными.
\begin{figure}[h]
            \begin{center}
               \includegraphics[width=10cm]{real-2-k.eps}
               %% \includegraphics[width=10cm]{real-1.eps}
                \caption{\rm Ход покраснения звезд по расстояниям в направлении
                 $l=5^\circ.00,  b= 24.04^\circ$.  По горизонтали расстояния в пк, по вертикали --- покраснение
                 (зв. вел.). При вычислении градиента $k$ отброшена одна точка (синий цвет).
                  Данные из каталога  Hipparcos.}
                \label{red-off}
            \end{center}
        \end{figure}


            \subsubsection{Устранение выбросов}
                          %Покраснения некоторых звезд вносят большие ошибки в искомые тренды.
            %%    Иногда они получаются вообще отрицательными, что противоречит здравому смыслу.
%%                Но об этом мы поговорим позже.

                При небольшом количестве звезд на луче зрения (в нашем случае 20) метод наименьших квадратов
                очень чувствителен к выбросам,
                т.е. большие ошибки значений покраснения и/или параллакса могут очень сильно испортить тренд.
                Для устранения этого недостатка после построения тренда по всем звездам в конусе,
                мы выбрасывали те, звезды, которые давали самые большие отклонение от  найденного тренда.
                   Затем, новое значение тренда определялось уже по только по оставшимся звездам.
                   После выброса 10\% самых плохих звезд тренд, к примеру, может быть таким, как это
                   показано на рис. \ref{red-off}.
                В данном случае, мы выбросили одну звезду (синюю).
                 Разумеется, нельзя  выбрасывать слишком много звезд из-за опасности <<подгонки>> данных под модель.
                 В нашем случае порог 10\% звезд --- это обычно 0, 1 или 2 звезды в каждом конусе.



        \subsection{Распределение коэффициента $k$ по небесной сфере}
            Тем самым, ход покраснения в конусе $C_i$ мы описываем одним числом
            $k_i$ --- скоростью роста покраснения в этом конусе.
            Она, как мы ранее выясняли, должна коррелировать с наличием пыли.
            Поэтому, составив карту распределения коэффициента $k$,
            мы составим панораму пыли в окрестности Солнца.


На рисунке \ref{k-dataset} показана карта распределения  градиентов покраснения звезд для звезд обучающего
множества. Черным цветов закрашены те площадки, для которых звезды обучающего множества не позволяют
вычислить покраснение, так как  для них не известны классы светимости. Число таких площадок равно ???.
            \begin{figure}[t!]
                \begin{center}
                    \includegraphics[width=10cm]{map-k-has-lumin.eps}
                    %%%%\caption{\rm Распределение градиента покраснения, построенного по звездам,
%%%%                    имеющим класс светимости в каталоге Hipparcos и показатель цвета по этому классу
%%%%                    светимости в таблице \cite{tsvetkov} (44658 звезд)}
%%%%                    %Сравнение этих двух карт с рис.\ref{bv_all_stars} покажет основной результат работы
%%%%                    %ПРАВИЛЬНО ЛИ Я ПОНИМАЮ, ЧТО ЭТА КАРТА ПОСТРОЕНА ТОЛЬКО ПО ОБУЧАЮЩЕМУ МНОЖЕСТВУ?} {\it ДА}
\caption{\rm Распределение градиента покраснения, построенного по звездам обучающего множества}.
                    %Сравнение этих двух карт с рис.\ref{bv_all_stars} покажет основной результат работы
                    %ПРАВИЛЬНО ЛИ Я ПОНИМАЮ, ЧТО ЭТА КАРТА ПОСТРОЕНА ТОЛЬКО ПО ОБУЧАЮЩЕМУ МНОЖЕСТВУ?} {\it ДА}
                    \label{k-dataset}
                \end{center}
            \end{figure}




Как было сказано выше, определение спектрального класса для остальных звезд, не входящих в обучающее
множество, нами производилось с помощью двумерного линейного классификатора. Карты градиентов покраснения,
построенные с помощью классификатора для звезд с B-V<0.6  и  B-V>0.6 показаны на рисунках \ref{bv_less0.6}
и \ref{bv_ge0.6}. Аналогичная карта, построенная по всем звездам, показана на рис.\ref{bv_all_stars}.
Сравнение этих карт с рис.\ref{k-dataset} показывает, что примененный нами метод машинного обучения для
сортировки звезд по III и V классам светимости позволил получить информацию  о межзвездном покраснении
практически для всей небесной сферы.

            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{map-k-left.eps}
                    \caption{\rm Распределение градиента покраснения,
                    построенного по звездам с $B - V < 0.6$ (44890 звезд)}
                    \label{bv_less0.6}
                \end{center}
            \end{figure}
            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{map-k-right.eps}
                    \caption{\rm Распределение градиента покраснения,
                    построенного по звездам с $B - V \ge 0.6$ (49309 звезд)}
                    \label{bv_ge0.6}
                \end{center}
            \end{figure}


            \begin{figure}[t!]
                \begin{center}
                    \includegraphics[width=10cm]{map-k-ed.eps}
                    \caption{\rm Распределение градиента покраснения,
                     построенного по всем звездам (94199 звезд)}
                    \label{bv_all_stars}
                \end{center}
            \end{figure}


%%%%\begin{figure}[h!]
%%%%                \begin{center}
%%%%                    \includegraphics[width=10cm]{J-H.eps}
%%%%                    \caption{\rm Распределение показателя цвета J-H }
%%%%                    \label{bv_all_stars}
%%%%                \end{center}
%%%%            \end{figure}



\subsection{Статистическая надежность градиентов покраснения}
На рисунке \ref{bv_all_stars} показаны в условной шкале цветов значения градиентов покраснения для всех
использованных нами 3888 площадок неба. Наибольшее значение найденных градиентов составляет 1.71 m/кпк,
среднее значение - 0.15 m/кпк,  среднее значение ошибки  градиента - 0.04 m/кпк. В связи с этим интересно
поставить вопрос о статистической достоверности значений градиентов, найденных в каждой площадке.
Традиционно при сделанном предположении о нормальном распределении градиентов  ответ на этот вопрос можно
получить, вычислив отношение значения градиента к его среднеквадратичной ошибке. Известно, что при
$k/\sigma_k$=3 надежность результата составляет 99.87 процента (правило трех сигм), при $k/\sigma_k$=2
надежность результата составляет 97.72 процентов.  На рисунке \ref{map-k-2sigma} показаны черным цветом
площадки, для которых  $k/\sigma_k <2$, то есть те площадки, на которых надежность определения градиентов
покраснения не превышает 97.72 процентов.

%%%$Pr[k/\sigma_k=3]=99.87$
%%%
%%%$Pr[k/\sigma_k=2]=97.72$
%%%
%%%$Pr[k/\sigma_k=1.5]=93.32$
%%%
%%%$Pr[k/\sigma_k=1]=84.13$

%%Думаю, что надо построить карту отношений $k/\sigma_k$.
            \begin{figure}[h!]
                \begin{center}
                    \includegraphics[width=10cm]{map-k-2sigma-ed.eps}
                    \caption{\rm Карта, на которой
                    черным цветом отмечены пиксели, в которых $k < 2 \sigma_k$}
                    \label{map-k-2sigma}
                \end{center}
            \end{figure}

\begin{figure}[h!]
                \begin{center}
                    \includegraphics[width=10cm]{J-K-ed.eps}
                    \caption{\rm Распределение показателя цвета J-H  (2MASS)}
                    \label{J-H}
                \end{center}
            \end{figure}

            \begin{figure}[h!]
                \begin{center}
                    \includegraphics[width=10cm]{HK-gam.eps}
                    \caption{\rm Распределение показателя цвета H-K (2MASS)}
                    \label{H-K}
                \end{center}
            \end{figure}


 \subsection{Сравнение с результатами, полученными с помощью 2MASS}


 На рисунках \ref{J-H}-\ref{H-K} показаны распределения по небесной сфере показателей цвета J-H и H-$K_s$ звезд
 по данным каталога  2MASS \cite{skrutckie}.
  На этих рисунках, полученных по показателям цвета в ближней инфракрасной области
  (J -- 1.2 $\mu m$,  H -- 1.6 $\mu m$  и Ks -- 2.2 $\mu m$),
 прослеживаются те же области, которые мы получили по покраснению $E(B-V)$ в оптическом диапазоне.
 Строго говоря,
 наши результаты  можно сравнивать  только  с показателями цветов, исправленными
 за стандартные значения,
 то есть с величинамами
\begin{equation} \label{jh}
E = E_{J-H} = (J-H)_{obs} - (J-H)_{int},\,\,\,\,
 E = E_{H-K_s} = (H-K_s)_{obs} - (H-K_s)_{int},
 \end{equation}


На рис. \ref{intr} показаны зависимости  стандартных (intrinsic) показателей цвета B-V, J-H, и $H-K_s$ от
спектрального класса \cite{binney}, \cite{straizys et al.}. Мы видим, что в формулах (\ref{jh}) поправка
за стандартное значение показателя цвета намного меньше, чем для B-V. Кроме того,  эти поправки слабо
зависят от   как от спектра звезд, так и от спектрального класса, то есть  практически одинаковы  для всех
звезд.  Это обстоятельство (особенно ярко выражено для  показателя цвета H-K) позволяет считать, что карты
 цветов в ближней инфракрасной области рис.\ref{J-H}  и рис.\ref{H-K} показывает детали,
 которые напрямую обуславливаются  именно межзвездным поглощением.


\begin{figure}[h!]
                \begin{center}
                    \includegraphics[width=7cm]{intrVa.eps}
                   \includegraphics[width=7cm]{intrIIIa.eps}
                    \caption{\rm Стандартные показатели цвета в зависимости от спектрального класса.
                    Слева спектральный класс V, справа --- III.
                     B-V (красная линия), J-H (синяя линия);
                    $H-K_s$ (зеленая линия) }
                    \label{intr}
                \end{center}
            \end{figure}

%%%%\begin{figure}[h!]
%%%%                \begin{center}
%%%%                    \includegraphics[width=8cm]{h-k_color.eps}
%%%%                   \caption{\rm Карта значений H-K  (по данным 2MASS) }
%%%%                    \label{intr}
%%%%                \end{center}
%%%%            \end{figure}






%%%%%            \begin{figure}[h!]
%%%%%                \begin{center}
%%%%%                    \includegraphics[width=10cm]{map-k-sigma0_05.png}
%%%%%                    \caption{\rm Карта \ref{bv_all_stars}, на которой
%%%%%                    черным цветом отмечены пиксели, в которых $\sigma_k > 0.05^m/\textrm{кпк}$}
%%%%%                    \label{map-k-sigma0_05}
%%%%%                \end{center}
%%%%%            \end{figure}
%%%%%
%%%%%            \begin{figure}[h!]
%%%%%                \begin{center}
%%%%%                    \includegraphics[width=10cm]{map-k-2sigma-or-sigma0_05.png}
%%%%%                    \caption{\rm Карта \ref{bv_all_stars}, на которой черным цветом отмечены пиксели, в которых $k < 2 \sigma_k$ либо $\sigma_k > 0.05^m/\textrm{кпк}$}
%%%%%                    \label{map-k-sigma0_05}
%%%%%                \end{center}
%%%%%            \end{figure}
%%%%%
%%%%%            Это небо в галактической системе координат с центром в центре галактики.
%%%%%             Сфера разбита на $12 \cdot 18^2 = 3888$ <<пикселей>> алгоритмом HEALPix. В каждом кусочке построен тренд покраснения $k r$. На этом рисунке изображено распределение значения коэффициента $k$ по пикселям. Синий цвет означает отрицательное значение $k$, красный - положительное. Чем насыщеннее цвет, тем больше значение коэффициента по модулю.
%%%%%

\newpage
    \section{Отрицательное покраснение}
        %Примеры отрицательного поглощения. 1) Существуют звезды с аномальным значением поглощения: значимое отрицательное приращение к показателю цвета. Случайные отклонения, связанные, например, с необычными спектральными характеристиками. 2) Существуют «картинки», в которых целый ряд звезд имеют неправильное поглощение – систематическая ошибка – попытаться выяснить природу. Таблица наиболее значительных отклонений от нормы. Диаграмма.

        На некоторых площадках коэффициент $k$ отрицательный. В теории, такого не должно быть, т.к. межзвездное поглощение не может делать звезды более голубыми. Пример хода покраснения на одной из площадок,
        \begin{figure}[h]
            \begin{center}
                \includegraphics[width=10cm]{real-4-k.eps}
                \caption{\rm Отрицательный ход покраснения}
                \label{pi_accuracy}
            \end{center}
        \end{figure}
        Мы видим, что это вызвано тем, что некоторые звезды имеют сильно отрицательное покраснение. То есть $E_{B - V} + 3 \sigma_{E_{B - V}} < 0$, где $\sigma$ --- это ошибка. Такого не должно быть, т.к. звезда не может сильно голубеть на расстоянии.
        Давайте рассмотрим какую-нибудь звезду, имеющую такое аномальное отрицательное покраснение. К примеру, HIP 66713. Ее параметры:
        \begin{itemize}
            \item Параллакс $7.99 \pm 0.77$
            \item Показатель цвета $0.386 \pm 0.014$
            \item Спектральный тип G0V
            \item Видимая звездная величина 8.37
        \end{itemize}
        Мы видим, что она не имеет аномальных параметров. Так же, ее параметры имеют небольшие ошибки. Согласно таблице в \cite{tsvetkov}, спектральному типу G0V соответствует показатель цвета $0.580$. Тем самым, покраснение $E = (B - V)_{obs} - (B - V)_{int} = (0.386 \pm 0.014) - 0.580 = -0,194 \pm 0.014$. Мы видим аномальное покраснение у не аномальной звезды.
        И таких звезд (имеющих $E_{B - V} + 3 \sigma_{E_{B - V}} < 0$) 11993 из 94670 (12.6\%), то есть достаточно много. Основные возможные причины таких отклонений --- неверные таблицы <<спектральный тип --- покраснение>>, ошибки в спектральной классификации (см. обучающее множество в <<Способах получения классов светимости>>). Этой проблеме будет посвящена следующая статья.


\section{Заключение}


Перечислим основные результаты, полученные в работе.

\begin{itemize}
    \item Создан бинарный классификатор, позволяющий звезде с известной абсолютной звездной величиной
    назначить класс светимости III или V.
    Для III класса светимости точность классификатора равна 95\%, полнота --- 89\%.
    Для V класса светимости  соответствующие характеристики  равны 91\% и 96\%.
    \item Для 98827-39807 =59020 звезд калога HIPPARCOS с помощью бинарного классификатора определены
    классы светимости.
    \item Для 98827 звезд каталога HIPPARCOS определены покраснения звезд по показателю цвета B-V.
    \item Получена карта значений градиента покраснения в направлениях, определяемых центрами 3888
    равновеликих площадок, построенных методом HealPix.
    \item Определена статистическая надежность результатов для каждой площадки.
    \item Произведено сравнение  карт покраснения, полученных нами в оптическом диапазоне,
     с аналогичными результатами, полученными в ближней инфракрасной области по данным каталога 2MASS.
     Практическое совпадение этих карт свидетельствует о надежной работе использованного нами бинарного
     классификатора.
\end{itemize}

    \section{Приложение}
        %%\subsection{Картирование небесной сферы}
%%            В данной работе, все изображения неба являются проекцией Хаммера
%%            небесной сферы в галактической системе координат,
%%            т.ч. в центре изображения --- центр галактики,
%%            сверху --- северный галактический полюс,
%%            снизу --- южный галактический полюс, увеличение
%%            галактических долгот справа налево. Небесная
%%            сфера разбита на <<пиксели>> стандартным алгоритмом HEALPix \cite{healpix}.
%%             Ключевым параметром (resolution parameter) алгоритма,
%%             определяющим разбиение сферы на равные площадки,
%%             является число $N_{side}$. Общее число пикселей
%%             $N_{pix} = 12 N_{side}^2$. Двумя параллелями со
%%              склонениям $\pm \arcsin(2/3)$ вся сфера разбивается
%%               на три части --- экваториальную и две полярные.
%%               В полярных зонах выбирается по $N_{side} - 1$ параллелей,
%%                в экваториальной зоне число параллелей равно $(2 N_{side} + 1)$.
%%                 На каждой параллели экваториальной области находятся центры  $4 N_{side}$ площадок.
%%                  Ближайшие к полюсам параллели всегда содержат по четыре площадки,
%%                  а при движении от полюсов к экватору в полярных зонах число площадок
%%                  на каждой параллели увеличивается на единицу.
%%                  Нумерация площадок $i = 0, \dots, N_{pix} - 1$ идет по параллелям с севера на юг.

        \subsection{Классификация данных методом опорных векторов}
            Задача классификации состоит в том, чтобы определить, к какому классу относится данный объект на основе обучающей выборки --- других объектов, про которые заранее известно, к каким классам они принадлежат. Каждый объект описывается числовыми атрибутами, поэтому задача классификации объектов сводится к задаче классификации точек в $\mathbb{R}^n$. Если классов всего два, то задача называется бинарной классификацией, если несколько —-- мультиклассификацией.

            Задачу классификации на $m$ классов можно сформулировать следующим образом, пусть есть обучающая выборка $(x_i, y_i), x_i \in \mathbb{R}^n, y_i \in \{1, \dots, m\}$. Требуется на основе обучающей выборки построить решающую функцию $F: \mathbb{R}^n \rightarrow \{1, \dots, m\}$, сопоставляющую класс любой точке из $\mathbb{R}^n$. В случае бинарной классификации, классы будет удобно обозначить за $\{-1, 1\}$.

            Бинарный классификатор назовем {\it линейным}, если его решающая функция выглядит следующим образом,
            $$
                F(x) = \sign (w \cdot x + b) = \sign\left(\sum\limits_{i = 1}^n w_i x_i + b\right),
            $$
            где $x_i$ --- компоненты вектора $x$, $b$ --- параметр, $w$ --- вектор, соответствующий нормали к {\it разделяющей гиперплоскости} (ее уравнение $w \cdot x + b = 0$). Классы $\{-1, 1\}$ назовем линейно разделимыми, если существует гиперплоскость, разделяющая точки разных классов по разным полупространствам относительно этой гиперплоскости.

            В простейшем случае, метод опорных векторов --- это алгоритм обучения линейного бинарного классификатора методом {\it максимального зазора}. Если классы $\{-1, 1\}$ линейно разделимы, это есть алгоритм нахождения гиперплоскости, которая наилучшим образом разделяет классы. То есть гиперплоскости $(w, b)$, которая находится на максимальном расстоянии до ближайшей точки <<-1>> класса и ближайшей точки <<1>> класса. Можно показать, что такая гиперплоскость будет иметь эти расстояния равными $\frac{1}{\left\| w \right\|}$ --- величине {\it зазора} (рис 13).
            \begin{figure}[h]
                \begin{center}
                    \includegraphics[width=10cm]{svm.eps}
                    \caption{\rm Решение задачи бинарной классификации в $\mathbb{R}^2$ методом опорных векторов}
                    \label{pi_accuracy}
                \end{center}
            \end{figure}
            Зазор должен быть максимальным, поэтому, для нахождения такой гиперплоскости требуется максимизировать $\frac{1}{\left\| w \right\|}$, то есть минимизировать $\left\| w \right\|^2$. Тем самым, метод опорных векторов сводится к решению следующей задачи,
            $$
                \left\{
                    \begin{array}{l}
                        \left\| w \right\|^2 \rightarrow \min   \\
                        \sign(w \cdot x_i + b) = y_i
                    \end{array}
                \right.
            $$
            где второе условие соответствует линейной разделимости обучающей выборки. Перепишем,
            $$
                \left\{
                    \begin{array}{l}
                        \left\| w \right\|^2  \rightarrow \min      \\
                        y_i (w \cdot x_i + b) \ge 1
                    \end{array}
                \right.
            $$
            что есть задача квадратичного программирования, которая решается с помощью множителей Лагранжа.

            Для того, чтобы алгоритм мог работать в случае, если классы линейно неразделимы, позволим ему допускать ошибки на обучающей выборке. Введем набор дополнительных переменных $\xi_i \ge 0$, характеризующих величину ошибки на точках $x_i$. Смягчим ограничения в неравенствах и введем в минимизируемый функционал штраф за суммарную ошибку,
            $$
                \left\{
                    \begin{array}{l}
                        \frac{1}{2} \left\| w \right\|^2 + C \sum_i \xi_i \rightarrow \min      \\
                        y_i (w \cdot x_i + b) \ge 1 - \xi_i    \\
                        \xi_i \ge 0
                    \end{array}
                \right.
            $$
            Где $C$ --- параметр настройки метода. Опять же, получилась задача квадратичного программирования. Эффективно такая задача может решаться такая с помощью метода <<Sequential Minimal Optimization>> (SMO) \cite{smo}.

        \subsection{Кросс-валидация, оценка качества работы классификатора}
            Для получения несмещенной оценки качества работы аналитической модели проводится {\it кросс-валидация}.
            Она заключается в том, что обучающая выборка дизъюнктно делится на две части --- тренировочное множество и тестовое множество, затем модель обучается на тренировочном множестве, а оценка качества работы получается на тестовом. Одним из способов проведения кросс-валидации является k-fold кросс-валидация. В этом случае обучающая выборка разбиваются на $k$ частей, затем на $k - 1$ части выборки производится обучение модели, а оставшаяся часть используется для тестирования. Процедура повторяется $k$ раз, в итоге каждая из $k$ частей используется в качестве тестовой. В результате получается оценка эффективности выбранной модели с наиболее равномерным использованием имеющихся данных.

            Для задачи классификации на $m$ классов, результатом кросс-валидации является таблица $m \times m$, в ячейке $i, j$ которой записано число объектов класса $i$ из тестового множества, про которые классификатор считает, что они принадлежат классу $j$. В случае k-fold кросс-валидации итоговая таблица $m \times m$ есть сумма всех $k$ таблиц, полученных из обучения + тестирования классификатора на каждом из $k$ разбиений на тренировочное и тестовое множество.

            По полученной таблице $C[m, m]$ можно считать различные метрики --- числа, характеризующие качество классификации,
            \begin{itemize}
                \item {\it Точность} определения класса $i$ --- $\frac{C_{ii}}{\sum\limits_{j = 1}^m C_{ji}}$
                \item {\it Полнота} определения класса $i$ --- $\frac{C_{ii}}{\sum\limits_{j = 1}^m C_{ij}}$
                \item {\it $F_1$-мера} определения класса $i$ - среднее гармоническое точности и полноты определения класса $i$
            \end{itemize}
%=======ПРИВЯЖИТЕ ЭТУ ТЕОРИЮ К ВАШИМ КОНКРЕТНЫМ ДАННЫМ ИЗ ТАБЛИЦЫ ===
%{\it ТАК В РАЗДЕЛЕ <<Способ получения классов светимости>> ЭТО И ДЕЛАЕТСЯ}




%%%%    \section{Заключение}
%%%%        %Получены определенные результаты. Найдены области с большим значением K (красные пиксели). Вопросы: отриц. поглощение – в дальнейшей работе будет проведено исследование.

  %%%   Этот раздел еще не создан

    \begin{thebibliography}{1}
        \bibitem{hipparcos} Perryman M.A.C., Lindegren L., Kovalevsky J., Hog E., Bastian U., Bernacca P.L., Creze M., Donati F., Grenon M., Grewing M., van Leeuwen F., van der Marel H., Mignard F., Murray C.A., Le Poole R.S., Schrijver H., Turon C., Arenou F., Froeschle M., Petersen C.S., "The Hipparcos Catalogue" (1997A\&A...323L..49P)
        \bibitem{tycho} Hog E., Baessgen G., Bastian U., Egret D., Fabricius C., Grossmann V., Halbwachs J.L., Makarov V.V., Perryman M.A.C., Schwekendiek P., Wagner K., Wicenec A., "The Tycho Catalogue" (1997A\&A...323L..57H)
        \bibitem{photometry} van Leeuwen F., Evans D.W., Grenon M., Grossmann V., Mignard F., Perryman M.A.C., "The Hipparcos mission: photometric data." (1997A\&A...323L..61V)
        \bibitem{hipnewcat} Hipparcos, the New Reduction of the Raw Data van Leeuwen F.,Astron. Astrophys. 474, 653 (2007),
        \bibitem{tycho} Wright et al. {\em Tycho-2 Spectral Type Catalog} 2003: The Astronomical Journal
        \bibitem{binney} Бинни, Меррифилд (J. Binney and M. Merrifield),
         Galactic Astronomy (Princeton: Princeton Univ. Press, 1998).
\bibitem{skrutckie} Скрутски и др., (Skrutskie, M. F., and 30 colleagues),
 The Two Micron All Sky Survey (2MASS).  The Astronomical Journal 131, 1163-1183, (2006).
        \bibitem{strigest} Страйджест – книжка
        \bibitem{straizys et al.} Straizys and Romualda Lazauskaite.
        INTRINSIC COLOR INDICES AND LUMINOSITY SEQUENCES OF STARS IN THE
        2MASS TWO-COLOR DIAGRAM V., Baltic Astronomy, vol. 18, 19–31, 2009.
        \bibitem{tsvetkov} А.А.Сминов, А.С.Цветков, А.В.Попов {\em Неточности в спектальной классификации звезд каталога Tycho-2 Spectral Type} 2006.
        \bibitem{svm} V.N.Vapnik {\em The Nature of Statistical Learning Theory} 1995.
        \bibitem{smo} Hastie, T.; Tibshirani, R. \& Friedman, J. (2001), {\em The Elements of Statistical Learning} , Springer New York Inc. , New York, NY, USA .
        \bibitem{healpix} Gorski et al. {\em HEALPix: A Framework for High-Resolution Discretization and Fast Analysis of Data Distributed on the Sphere} 2005.
    \end{thebibliography}


intrinsic 1) внутренний

2) действительный 3) природный 4) ествественный 5) присущий 6) собственный 7) характеристический




\end{document}
