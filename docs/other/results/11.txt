Практически у всех звезд северного полушария, представленных в каталоге Hipparcos, отсутствует класс светимости.
Для нас его наличие чрезвычайно важно, ввиду того, что мы на основе класса светимости и спектрального класса мы считаем
истинное значение B-V для звезд. Тем самым, отсутствие классов светимости у половины звезд делает невозможным проведение
наших расчетов для всего северного полушария.

Исправим это. Рассчитаем неизвестные классы светимости. Сделаем это с помощью методов машинного обучения. Натренируем
классификатор, который будет выдавать класс светимости для звезды по двум факторам - показателю цвета и абсолютной
звездной величине. Этих факторов будет достаточно, т.к. классы светимости теоретически разделимы на диаграмме
Гершпрунга-Рассела. Тренировать классификатор мы будем с помощью метода опорных векторов (Support Vector Machines, SVM).

В качестве обучающего множества возьмем звезды с известными спектральными классами и приемлемыми ошибками в
расстоянии. (11.png)
Факторами для обучения у нас будут показатель цвета абсолютная звездная величина.

Про SVM - ссылка

Для оценки эффективности классификатора проведем 10-fold кросс-валидацию. Ниже приведены ее результаты,

Correctly Classified Instances       12788               92.9631 %
Incorrectly Classified Instances       968                7.0369 %
Kappa statistic                          0.8273
Mean absolute error                      0.0704
Root mean squared error                  0.2653
Relative absolute error                 16.3717 %
Root relative squared error             57.2227 %
Coverage of cases (0.95 level)          92.9631 %
Mean rel. region size (0.95 level)      50      %
Total Number of Instances            13756

=== Confusion Matrix ===

    a    b   <-- classified as
 3405  896 |    a = III
   72 9383 |    b = V

=== Detailed Accuracy By Class ===

                 TP Rate  FP Rate  Precision  Recall   F-Measure  MCC      ROC Area  PRC Area  Class
                 0,792    0,008    0,979      0,792    0,876      0,836    0,892     0,840     III
                 0,992    0,208    0,913      0,992    0,951      0,836    0,892     0,911     V
Weighted Avg.    0,930    0,146    0,934      0,930    0,927      0,836    0,892     0,889


Замечание.
Как Вы могли заметить, обучение проводилось только на звездах III и V классов ввиду того, что все остальные классы
ничтожно малы по сравнению с ними.

Тем самым, классификатор можно считать хорошим. Результат применения классификатора ко всем звездам с приемлемой ошибкой
в расстоянии представлен на рисунке 12.png. Так же на этом рисунке представлены ошибки в показателе цвета у случайных
20% звезд.


